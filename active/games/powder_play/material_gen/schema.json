{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MBL Material",
  "type": "object",
  "required": ["type","name"],
  "properties": {
    "type": {"const": "material"},
    "name": {"type": "string"},
    "description": {"type": "string"},
    "color": {
      "oneOf": [
        {"type": "string"},
        {"type": "array", "minItems": 3, "maxItems": 4, "items": {"type": "integer", "minimum": 0, "maximum": 255}}
      ]
    },
    "density": {"type": "number", "minimum": 0},
    "tags": {
      "type": "array",
      "minItems": 1,
      "items": {"type": "string", "enum": ["sand","flow","float"]}
    },
    "primitives": {
      "type": "array",
      "items": {"type":"object"}
    },
    "reactions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["with","result"],
        "properties": {
          "with": {"type":"string"},
          "result": {"type":"string"},
          "byproduct": {"type":"string"},
          "probability": {"type":"number","minimum":0,"maximum":1},
          "priority": {"type":"number"}
        }
      }
    },
    "condense": {
      "type": "object",
      "required": ["at","result"],
      "properties": {
        "at": {"type":"string", "enum": ["top"]},
        "result": {"type":"string"},
        "probability": {"type":"number","minimum":0,"maximum":1}
      }
    },
    "budgets": {
      "type": "object",
      "properties": {
        "max_ops": {"type":"integer","minimum":1,"maximum":200},
        "max_spawns": {"type":"integer","minimum":0,"maximum":4}
      },
      "required": ["max_ops","max_spawns"]
    }
  },
  "anyOf": [
    {
      "required": ["primitives","budgets"]
    },
    {
      "required": ["tags","density","color"]
    }
  ]
}